<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= user.userName %>'s Wedding Planner'</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous"></head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="css/sidebar.css" />
  <link rel="stylesheet" href="css/right-main.css">
  <link rel="stylesheet" href="css/calender.css">
  <!-- Body Container -->
<body class="d-flex flex-row h-100 bg-white">
  <!-- Sidebar 
        Issue#1:
        Wasn't able to get the logout button to populate the bottom of the sheet-->
  <div class="flex-shrink-0 p-3 bg-white" style="width: 280px;">
    <a href="/" class="d-flex align-items-center pb-3 mb-3 link-dark text-decoration-none border-bottom">
      <svg class="bi pe-none me-2" width="30" height="24"><use xlink:href="#bootstrap"/></svg>
      <span class="fs-5 fw-semibold">Wedding Planner</span>
    </a>
    <ul class="list-unstyled ps-0">
          <li class="mb-1">
      <button class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed" data-bs-toggle="collapse" data-bs-target="#home-collapse" aria-expanded="true">
        <%= user.userName %>'s Wedding Plan
      </button>
      <div class="collapse show" id="home-collapse">
        <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            <li class="mb-1">
                <button class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed" data-bs-toggle="collapse" data-bs-target="#food-collapse" aria-expanded="true">
                  Food
                </button>
                <div class="collapse show" id="food-collapse">
                  <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                    <% todos.forEach( el => { %>
                      <% if(el.category === 'food'){ %>
                    <li class='todoItem' data.id="<%=el.id%>">
                      <a class="link-dark d-inline-flex text-decoration-none rounded <%= el.completed === true ? 'completed' : 'not'%>'><%= el.todo %>"></a>
                    </li>
                        <% } %>
                    <% }) %>   
                  </ul>
                </div> 
              </li>
      </div>
    </li>
      <li class="mb-1">
        <button class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed" data-bs-toggle="collapse" data-bs-target="#dashboard-collapse" aria-expanded="false">
          Shared Wedding Plans
        </button>
        <div class="collapse" id="dashboard-collapse">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            <li><a href="#" class="link-dark d-inline-flex text-decoration-none rounded">Overview</a></li>
            <li><a href="#" class="link-dark d-inline-flex text-decoration-none rounded">Weekly</a></li>
            <li><a href="#" class="link-dark d-inline-flex text-decoration-none rounded">Monthly</a></li>
            <li><a href="#" class="link-dark d-inline-flex text-decoration-none rounded">Annually</a></li>
          </ul>
        </div>
      </li>
      <li class="border-top my-3"></li>
      <a class="w-100 btn btn-lg btn-primary" href="/logout">Sign Out</span>
    </a>
    </ul>
  </div>
  <!-- Right container -->
    <div class="d-flex bg-white flex-column">
  
      <!-- Top Container: Calender - Search - New Task -->
      <div class="d-flex justify-content-between">
        <!-- Left Container: Calender 
            Issue#2:
            The idea was to be able to recflect the dates
            queried from the todo, jquery is already added, just need to add a function
            to apply the event class inside of the calendar.css-->
        <div class="d-sm-flex">
      <div class="calendar">
        <div class="year-header">
          <span class="left-button fa fa-chevron-left" id="prev"> </span>
          <span class="year" id="label">2022</span>
          <span class="right-button fa fa-chevron-right" id="next"> </span>
        </div>
          <table class="months-table w-100">
            <tbody>
            <tr class="months-row">
            <td class="month">Jan</td>
            <td class="month">Feb</td>
            <td class="month">Mar</td>
            <td class="month">Apr</td>
            <td class="month">May</td>
            <td class="month">Jun</td>
            <td class="month">Jul</td>
            <td class="month">Aug</td>
            <td class="month active-month">Sep</td>
            <td class="month">Oct</td>
            <td class="month">Nov</td>
            <td class="month">Dec</td>
            </tr>
            </tbody>
          </table>
          <table class="days-table w-100">
            <tbody><tr><td class="day">Sun</td>
            <td class="day">Mon</td>
            <td class="day">Tue</td>
            <td class="day">Wed</td>
            <td class="day">Thu</td>
            <td class="day">Fri</td>
            <td class="day">Sat</td>
            </tr></tbody></table>
          <div class="frame">
          <table class="dates-table w-100">
          <tbody class="tbody"><tr class="table-row"></tr><tr class="table-row"><td class="table-date nil"></td><td class="table-date nil"></td><td class="table-date nil"></td><td class="table-date nil"></td><td class="table-date">1</td><td class="table-date">2</td><td class="table-date">3</td></tr><tr class="table-row"><td class="table-date active-date">4</td><td class="table-date">5</td><td class="table-date">6</td><td class="table-date">7</td><td class="table-date">8</td><td class="table-date">9</td><td class="table-date">10</td></tr><tr class="table-row"><td class="table-date">11</td><td class="table-date">12</td><td class="table-date">13</td><td class="table-date">14</td><td class="table-date">15</td><td class="table-date">16</td><td class="table-date">17</td></tr><tr class="table-row"><td class="table-date">18</td><td class="table-date">19</td><td class="table-date">20</td><td class="table-date">21</td><td class="table-date">22</td><td class="table-date">23</td><td class="table-date">24</td></tr><tr class="table-row"><td class="table-date">25</td><td class="table-date">26</td><td class="table-date">27</td><td class="table-date">28</td><td class="table-date">29</td><td class="table-date">30</td><td class="table-date nil"></td></tr><tr class="table-row"><td class="table-date nil"></td><td class="table-date nil"></td><td class="table-date nil"></td><td class="table-date nil"></td></tr></tbody>
          </table>
    </div>
    </div>
    </div>
    <!--Calender End-->

        <!-- Right Top Container: Search - New Task
                Issue #3:
                Had problems applying padding and margins
                for the boxes containing Search and New Task form
                Also wanted to add a title or something above the new task form-->
          <div class="d-flex flex-column justify-content-between my-3 mr-5">
            <!-- Right Upper Search Container
                Issue #4:
                Their is currently no search functionality -->
            <div class="d-flex">
            
            <form class="d-flex justify-content-end" role="search">
                      <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                      <button class="btn btn-outline-dark" type="submit">Search</button>
                    </form>
            </div>
            <!-- Right Lower New Task Container
                See Issue#3 -->
            <div class="d-flex bg-secondary justify-content-around align-items-end p-5">
               <form class="p-2" action="/todos/createTodo" method='POST'>
          <input type="text" placeholder="Enter a New Wedding Task" name='todoItem'>
          <input type="date" id="dateDue" name="dateDue"
         min="2022-01-01" max="2024-12-31">
  
         <!-- mdcv: Added dropdown menu to select priority level -->
          <select id="category" name="category">
              <option value="" selected="true" disabled="disabled">Select Category</option>
              <option name="category" value="food">Food</option>
              <option name="category" value="vendors">Vendors</option>
              <option name="category" value="clothing">Clothing</option>
          </select>
          <input type="submit">
               </form>  
          </div>
        </div>
      </div>
    
    <!-- Right Lower Task Container -->
        <div class="container-tasks d-flex align-items-end flex-wrap">
              <div class="album py-5 bg-light">
                <div class="container">
                  <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
                    <!-- This is the start of the loop which pulls the to do lists and
                        populates them inside of the container -->
                    <% todos.forEach( el => { %>
                  <div class="col">
                      <div class="card shadow-sm">
                        <div class="card-body todoItem" data-id='<%=el._id%>'>
                          <p class='h5 <%= el.completed === true ? 'completed' : 'not'%>'>
                              <%= el.todo %>
                          </p>
                          <p class="card-text ">
                              Due: <%= el.dateDue %>
                          </p>
                          <p class="card-text ">
                              Days remaining: <%= Math.ceil((new Date(Date.parse(el.dateDue)).getTime() - new Date().getTime() )/ (1000 * 3600 *24))%>
                          </p>
                          <div
                            class="d-flex justify-content-between align-items-center"
                          >
                            <div class="btn-group">
                                <!--Issue #4 - Delete listener isn't applied to the button -->
                              <button
                                type="button"
                                class="del btn btn-sm btn-outline-secondary"
                              >
                                Delete
                              </button>
                              <!--This button calls the modal located at the bottom,
                                    it contains Nick's share form, see Issue#5-->
                              <button
                                type="button"
                                class="btn btn-sm btn-outline-secondary"
                                data-bs-toggle="modal"
                                data-bs-target="#staticBackdropLive"
                              >
                                Share
                              </button>
                            </div>
                            <small class="text-muted">9 mins</small>
                          </div>
                        </div>
                      </div>
                    </div>
                    <% }) %> 
                    <!--Ending of the above loop-->  
                  </div>
                </div>
              </div>
            </div>
    </div>
    <!--The above div closes the whole of the Right Container -->

    <!-- Below contains the modal that will pop up when you click the share button on a task
        Issue #5:
        Didn't test the functionality of the share button, will need to be debugged,
        probably just add a unique id or something, otherwise there will be additional
        errors because they're very dependent on parent elements holding the id-->
  
  <div class="modal fade" id="staticBackdropLive" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLiveLabel" style="display: none;" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="staticBackdropLiveLabel">Modal title</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
                <!-- * nshoemake -->
                <!-- ! Added form submission for username, submitting this will "push" the task to the other user (it will show up on their views) -->
                <form action="/todos/shareTodo" method='POST'>
                    <input type="hidden" name="_method" value="PUT">
                    <input type="hidden" name="todoId" value="<%=el._id%>">
                    <input type="text" placeholder="Enter Username" name='shareWithUserId'>
                    <input type="submit">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  




  <!--CDN Bootstrap + js -->
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
    <script src="js/main.js"></script>
    <script src="js/sidebars.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.5/dist/umd/popper.min.js" integrity="sha384-Xe+8cL9oJa6tN/veChSP7q+mnSPaj5Bcu9mPX5F5xIGE0DVittaqT5lorf0EI7Vk" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js" integrity="sha384-ODmDIVzN+pFdexxHEHFBQH3/9/vQ9uori45z4JjnFsRydbmQbmL5t1tQ0culUzyK" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
<script src="js/calender.js"></script>
</body>
</html>